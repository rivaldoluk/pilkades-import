<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Pilkades 2025 - Import Wallet</title>
  <style>
    body {font-family: Arial; text-align:center; padding:50px 20px; background:#000; color:white; margin:0; min-height:100vh;}
    h1 {color:#ff6b00; font-size:2.5em;}
    button {padding:18px 40px; font-size:20px; background:#ff6b00; color:white; border:none; border-radius:50px; cursor:pointer; margin:15px;}
    button:hover {background:#e55a00;}
    .info {background:#111; padding:20px; border-radius:15px; margin:20px auto; max-width:500px;}
    .pk {background:#222; padding:15px; border-radius:10px; word-break:break-all; margin:20px; font-family:monospace;}
  </style>
</head>
<body>
  <h1>ðŸ‡®ðŸ‡© Pilkades 2025</h1>
  <div class="info">
    <p><strong>Wallet kamu sudah siap!</strong></p>
    <p>Klik tombol di bawah â†’ wallet otomatis masuk ke MetaMask</p>
  </div>

  <button onclick="openMetaMask()">ðŸš€ Import ke MetaMask Sekarang</button>
  <button onclick="copyPK()" style="background:#333;">ðŸ“‹ Copy Private Key (Manual)</button>

  <div class="pk" id="pkBox"></div>

  <script>
    const params = new URLSearchParams(location.search);
    const pk = params.get('pk');

    if (!pk || pk.length !== 64) {
      document.body.innerHTML = "<h1 style='color:#ff4757;'>Private Key Tidak Valid!</h1>";
      throw new Error("No valid PK");
    }

    document.getElementById("pkBox").textContent = "0x" + pk;

    function openMetaMask() {
      const url = location.href;
      const mmDeepLink = "https://metamask.app.link/dapp/" + encodeURIComponent(url);
      location.href = mmDeepLink;
    }

    function copyPK() {
      navigator.clipboard.writeText("0x" + pk);
      alert("Private key sudah dicopy!\nSekarang buka MetaMask â†’ Import Account â†’ paste di sana.");
    }

    // Kalau sudah dibuka dari MetaMask browser â†’ langsung kasih pesan sukses
    if (window.ethereum || navigator.userAgent.includes("MetaMaskMobile")) {
      setTimeout(() => {
        alert("Wallet berhasil di-import!\n\nAddress akan muncul di MetaMask kamu.\nSekarang kamu bisa voting!");
        // Ganti link voting kamu di sini kalau mau redirect
        // location.href = "https://your-voting-site.com";
      }, 1500);
    }
  </script>
</body>
</html>
